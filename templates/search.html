{% extends "base.html" %}

{% block title %}Search Results - {{ config.NAME }}{% endblock %}

{% block content %}
<div class="container">
    <div class="search-wrapper">
        <div class="search-header">
            <h2>Search Results</h2>
            <form action="/search" method="get" class="search-form-large">
                <input type="text" name="q" placeholder="Search wiki pages..." value="{{ query }}" required>
                <input type="hidden" name="branch" value="{{ branch or 'main' }}">
                <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> Search</button>
            </form>
        </div>

        {% if query or show_all %}
        <div class="search-results">
            {% if show_all and not query %}
            <h3>All Pages</h3>
            {% else %}
            <h3>Results for "{{ query }}"</h3>
            {% endif %}
            {% if pages %}
            <div class="page-list">
                {% for page in pages %}
                <div class="page-item">
                    <h4><a href="/page/{{ page.title }}?branch={{ page.branch or 'main' }}">{{ page.title }}</a></h4>
                    <p>Last updated: {{ page.updated_at.strftime('%Y-%m-%d %H:%M') }} by {{ page.author }}{% if page.branch and page.branch != 'main' %} (Branch: {{ page.branch }}){% endif %}</p>
                    <div class="page-preview">
                        {% if page.content %}
                        {{ page.content[:200] }}...
                        {% endif %}
                    </div>
                    <div class="page-actions">
                        <a href="/page/{{ page.title }}?branch={{ page.branch or 'main' }}" class="btn btn-primary"><i class="fas fa-eye"></i> View</a>
                        <a href="/edit/{{ page.title }}?branch={{ page.branch or 'main' }}" class="btn btn-secondary"><i class="fas fa-edit"></i> Edit</a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}

                {% endif %}
        </div>

        {% elif not show_all %}
        <div class="search-instructions">
            <h3>Search Instructions</h3>
            <p>Enter a search term above to find wiki pages by title or content.</p>
            <p>You can also:</p>
            <ul>
                <li><a href="/search?branch={{ branch or 'main' }}&show_all=true">View all pages</a></li>
                    {% if can_create_page %}
                    <li><a class="create-page-btn"><i class="fas fa-plus"></i> Create Page</a></li>
                    {% endif %}
                </ul>
            </div>
        {% endif %}
    </div>
</div>

{% endblock %}
